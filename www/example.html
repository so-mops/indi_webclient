<!DOCTYPE html>
<html>
	<head>
  <script src="//code.jquery.com/jquery-1.12.4.js"></script>
	<script src="//code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script src="/indi.js"></script>
	<script>
	function main()
	{
		var url="ws://swindell:3000";
		INDIwebsocket(url, 'body');
	}	

	function postProc(INDIvp, ele)
	{
	var devselector = "div.INDIdevice#"+nosp(INDIvp.device);
	var grpselector = devselector+" span.INDIgroup#"+nosp(INDIvp.group);
	var menuselector = devselector+" ul.devmenu li ul"

	if( $(grpselector).length == 0 )
	{
	if( $(menuselector).length == 0 )
	{
		$("<ul/>", 
		{
		}).addClass("devmenu").append(
		$("<li>")
			.append($("<a/>").text( "Widget List" ))
			.append( "<ul></ul>" ) )
			.prependTo( devselector ).after($("<hr/>")).menu()
			
	}
	$("<li/>").append($("<a/>").css({"white-space":"nowrap"}).on("click", function(event){$(grpselector).toggle()}).text( INDIvp.group )).appendTo( menuselector );
	$(menuselector).closest("ul.devmenu").menu("refresh");

	$("<span/>", {id:nosp(INDIvp.group)}).addClass("INDIgroup").appendTo(devselector)
	$(grpselector).append("<h3>"+INDIvp.group+"</h3>").controlgroup();
	}
	else
	{
		switch(INDIvp.state)
		{
			case(INDISTATE_IDLE ):
				$(ele).css('background-color', 'transparent')
			break;
			case(INDISTATE_OK ):
				$(ele).css('background-color', '#008800')
			break;
			case(INDISTATE_BUSY ):
				$(ele).css('background-color', '#bbbb00')
			break;
			case(INDISTATE_ALERT ):
				$(ele).css('background-color', '#880000')
			break;
			default:
				console.log("idk", data.name, data.state);
		}
	}


	return grpselector;
	}


	</script>
	<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/eggplant/jquery-ui.css">
	</head>
	<body onload="main()">
		

	</body>
</html>
